package io.ivyteam.devops.repo.check;

import io.ivyteam.devops.repo.Repo;

class VulnerabilityScanningEnabledRepoCheck implements RepoCheck {

  @Override
  public Result check(Repo repo) {
    if (repo.archived()) {
      return Result.success("Archived repository do not need vulnerarbilty scanned turned on");
    }
    if (repo.isVulnAlertOn()) {
      return Result.success("Repository has vulnerability scanned turned on");
    }
    return Result.success("Repository has vulnerability scanned turned off");
  }
}
